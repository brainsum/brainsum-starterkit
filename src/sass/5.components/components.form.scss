/**
 * @file
 * Form Component
 *
 * Theming common form elements. Just import it (attach the form library) where
 * is a form item, and only theming the component-specific things stand-alone.
 */

/**
  * Imports
 */
@import "../global.importer";

/**
 * Settings
 */
$form-browser-input-icons     : false;
$form-gutter-block            : $global-form-gutter;
$form-padding-block           : $global-form-padding-block;
$form-padding-inline          : $global-form-padding-inline;
$form-border-radius           : ($form-padding-block * 2 + $global-line-height * 1.8rem) * 0.5;
$form-border-color            : #979797;
$form-focus-color             : $color-brand;
$form-text-color              : $global-color;
$form-background-color        : $color-light;
$form-placeholder-color       : rgba($form-text-color, 0.66);
$form-boolean-border-color    : #979797;
$form-boolean-checked-color   : $color-brand;
$form-boolean-size-touch      : 3.5rem; // size for mobile devices
$form-boolean-size-mouse      : 2.6rem; // size for desktop
$form-checkbox-border-radius  : 0.2rem;
$form-select-arrow-size       : 2.8rem;

textarea {
  resize: vertical;
}

// Reset webkit date and time fields (hide calendar and clock icons)
@if $form-browser-input-icons == false {
  input[type="date" i]::-webkit-calendar-picker-indicator,
  input[type="time" i]::-webkit-calendar-picker-indicator {
    display: none;
  }
}

.c-form {
  &-item:not(:first-child) {
    margin-block-start: $form-gutter-block;
  }

  /**
   * Text form elements
   *   - input type: text, email, number, date, time, password...
   *   - textarea
   */
  &-element {
    appearance: none;
    width: 100%;
    padding-block: $form-padding-block;
    padding-inline: $form-padding-inline;
    color: $form-text-color;
    border: 0.1rem solid $form-border-color;
    border-radius: $form-border-radius;
    background: $form-background-color;

    @include input-placeholder {
      color: $form-placeholder-color;
    }

    &:focus {
      outline: none;
      box-shadow: 0 0 1rem rgba($form-focus-color, 0.5);
    }

    &.form-textarea {
      min-height: $form-padding-block * 2 + 9 * $global-line-height * 1.8rem;

      @include breakpoint(medium) {
        min-height: $form-padding-block * 2 + 11 * $global-line-height * 1.8rem;
      }
    }
  }

  /**
   * Boolean type form elements
   *   - radio
   *   - checkbox
   */
  &-type--boolean {
    position: relative;
    display: flex;
    flex-direction: row;
    align-items: center;
    min-height: $form-boolean-size-touch;
    margin-block: 2rem;
    margin-inline: 0;
    cursor: pointer;
    line-height: $form-boolean-size-touch;

    @include breakpoint(medium) {
      min-height: $form-boolean-size-mouse;
      margin-block: 1.5rem;
      line-height: $form-boolean-size-mouse;
    }

    input {
      @include visually-hidden;

      &:checked + label::after {
        border-color: $form-boolean-checked-color;
        background: $form-boolean-checked-color;
      }

      &:disabled,
      &.is-disabled {
        opacity: 0.5;
      }
    }

    label {
      position: relative;
      padding-inline-start: $form-boolean-size-touch + 2rem;
      cursor: pointer;

      @include breakpoint(medium) {
        padding-inline-start: $form-boolean-size-mouse + 1.5rem;
      }

      &::before {
        @include square($form-boolean-size-touch * 0.6);

        position: absolute;
        z-index: 9;
        inset-block-start: $form-boolean-size-touch * 0.2;
        inset-inline-start: $form-boolean-size-touch * 0.2;
        content: "";

        @include breakpoint(medium) {
          @include square($form-boolean-size-mouse * 0.6);

          inset-block-start: $form-boolean-size-mouse * 0.2;
          inset-inline-start: $form-boolean-size-mouse * 0.2;
        }
      }

      &::after {
        @include square($form-boolean-size-touch);

        position: absolute;
        inset-block-start: 0;
        inset-inline-start: 0;
        display: inline-block;
        content: "";
        cursor: pointer;
        transition:
          background 0.2s,
          border 0.2s,
          box-shadow 0.2s,
          color 0.2s;
        border: 1px solid $form-boolean-border-color;
        background: $form-background-color;

        @if $prefers-reduced-motion {
          @media screen and (prefers-reduced-motion: reduce) {
            transition: none;
          }
        }

        @include breakpoint(medium) {
          @include square($form-boolean-size-mouse);
        }
      }
    }
  }
}

.js-form {
  &-type-radio {
    label {
      &::before {
        border-radius: 50%;
        background: $form-background-color;
      }

      &::after {
        border-radius: 50%;
      }
    }
  }

  &-type-checkbox {
    label {
      &::before {
        // Font Awesome's check icon (https://fontawesome.com/icons/check?style=solid) with white fill has been encoded with https://www.base64encode.org/.
        background: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMTczLjg5OCA0MzkuNDA0bC0xNjYuNC0xNjYuNGMtOS45OTctOS45OTctOS45OTctMjYuMjA2IDAtMzYuMjA0bDM2LjIwMy0zNi4yMDRjOS45OTctOS45OTggMjYuMjA3LTkuOTk4IDM2LjIwNCAwTDE5MiAzMTIuNjkgNDMyLjA5NSA3Mi41OTZjOS45OTctOS45OTcgMjYuMjA3LTkuOTk3IDM2LjIwNCAwbDM2LjIwMyAzNi4yMDRjOS45OTcgOS45OTcgOS45OTcgMjYuMjA2IDAgMzYuMjA0bC0yOTQuNCAyOTQuNDAxYy05Ljk5OCA5Ljk5Ny0yNi4yMDcgOS45OTctMzYuMjA0LS4wMDF6Ij48L3BhdGg+PC9zdmc+") no-repeat center center;
        background-size: contain;
      }

      &::after {
        border-radius: $form-checkbox-border-radius;
      }
    }
  }
}

.field--widget-options-select,
.c-form-item--select,
.c-form-item-created {
  position: relative;

  &::after {
    @include square($form-select-arrow-size);

    position: absolute;
    inset-block-start: 50%;
    inset-inline-end: $form-padding-inline;
    display: block;
    content: "";
    transform: translateY(-50%);
    pointer-events: none;

    // Font Awesome's angle-down pro icon (https://fontawesome.com/icons/angle-down?style=regular) with branding color fill has been encoded with https://www.base64encode.org/.
    background: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMjAgNTEyIj48cGF0aCBmaWxsPSIjZjdjYTAwIiBkPSJNMTUxLjUgMzQ3LjhMMy41IDIwMWMtNC43LTQuNy00LjctMTIuMyAwLTE3bDE5LjgtMTkuOGM0LjctNC43IDEyLjMtNC43IDE3IDBMMTYwIDI4Mi43bDExOS43LTExOC41YzQuNy00LjcgMTIuMy00LjcgMTcgMGwxOS44IDE5LjhjNC43IDQuNyA0LjcgMTIuMyAwIDE3bC0xNDggMTQ2LjhjLTQuNyA0LjctMTIuMyA0LjctMTcgMHoiPjwvcGF0aD48L3N2Zz4=") no-repeat center center;
    background-size: contain;
  }

  select {
    padding-inline-end: $form-padding-inline * 2;
    cursor: pointer;
  }
}
