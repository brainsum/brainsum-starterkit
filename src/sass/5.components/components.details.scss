/**
 * @file
 * Collapsible details.
 *
 * Based on Olivero.
 */

/**
  * Imports
 */
@import "../global.importer";

/**
 * Settings
 */
$details-border-width       : 0.1rem;
$details-border-radius      : 0.2rem;
$details-summary-transition : background-color 0.12s ease-in-out;

.c-details {
  @include round($details-border-radius);

  display: block;
  margin-block: $gutter;
  color: inherit;
  border-block: $details-border-width solid $color-grey-20;
  border-inline: $details-border-width solid $color-grey-20;
  box-shadow: 0 0.1rem 0.4rem $color-grey-30;

  /* Details summary styles */
  &__summary {
    position: relative;
    padding-block: $gutter;
    padding-inline-start: $gutter * 2;
    padding-inline-end: $gutter;
    list-style: none;
    cursor: pointer;
    transition: $details-summary-transition;
    word-wrap: break-word;
    hyphens: auto;
    color: inherit;
    background-color: $color-grey-10;
    font-size: 1.4rem;
    font-weight: 700;
    line-height: 1.28;

    @if $prefers-reduced-motion {
      @media screen and (prefers-reduced-motion: reduce) {
        transition: none;
      }
    }

    /* Arrow icon */
    &::before {
      @include square(1rem);

      position: absolute;
      inset-block-start: 50%;
      inset-inline-start: $gutter * 0.75;
      display: block;
      content: "";
      transform: translateY(-50%) rotate(45deg); // LTR
      border-block-start: solid 0.2rem currentColor;
      border-inline-end: solid 0.2rem currentColor;

      // RTL
      [dir="rtl"] & {
        transform: translateY(-50%) rotate(-135deg);
      }
    }

    // Pseudo-selector to manage focus styles
    &::after {
      @include round($details-border-radius);

      position: absolute;
      inset: calc($details-border-width * -1);
      content: "";
      pointer-events: none;
      opacity: 0;
      box-shadow: inset 0 0 0 0.2rem $color-brand;
    }

    /* Hide the marker */
    &::-webkit-details-marker {
      display: none;
    }

    /* Disable default outline for summary, since we have own implementation */
    &:focus {
      outline: solid 0.2rem transparent;
      outline-offset: -0.4rem;
    }

    /* Details summary, hover state */
    &:hover {
      background-color: $color-grey-20;
    }

    /* Details summary, focus and active states */
    &:focus,
    &:active {
      &::after {
        opacity: 1;
      }
    }

    /* Rotate arrow icon of the details summary, when details expanded */
    .c-details[open] > & {
      &::before {
        margin-block-start: -0.2rem;
        transform: translateY(-50%) rotate(135deg);
      }
    }
  }

  /* Details content wrapper */
  &__wrapper {
    margin-block: $gutter;
    margin-inline: $gutter;

    @include breakpoint(large) {
      margin-block: $gutter * 1.5;
      margin-inline: $gutter * 2;
    }
  }

  /* Description */
  &__description {
    margin-block-end: $gutter;
    color: $color-grey-90;
    font-size: 1.3rem;
    line-height: 1.38;
  }
}
